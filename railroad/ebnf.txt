RULE ::= '(' 'defrule' RULENAME DOCSTRING CONDITION+ '=>' S-EXPRESSION ')'

QUERY ::= '(' 'defquery' QUERYNAME DOCSTRING '[' ARG* ']' '[' CONDITION+ ']' ')'

CONDITON ::= BOOLEAN_EXPR | ACCUM_EXPR | FACT_CONSTRAINT | TEST_EXPR

BOOLEAN_EXPR ::= '[' ( ':and' | ':or' | ':not' ) (BOOLEAN_EXPR | FACT_CONSTRAINT) ']'

ACCUM_EXPR ::= '[' BINDING '<-' ACCUMULATOR ':from' FACT_CONSTRAINT ']'

FACT_CONSTRAINT ::= '[' (BINDING '<-')? FACT_TYPE ( '[' DESTRUCTURED_FACT ']' )?  S-EXPRESSION* ']'

TEST_EXPR ::= '[' ':test' S-EXPRESSION* ']'

BINDING ::= 'A clojure symbol starting with a question mark. (?)'

FACT_TYPE ::= ( KEYWORD | CLASS )

DESTRUCTURED_ARGS ::= 'An optionally destructured argument, just as one would destructructure arguments to a Clojure function.'
